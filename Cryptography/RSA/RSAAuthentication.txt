> # ----------------------------------------------
> # Аутентификация.
> # ----------------------------------------------
> with(numtheory):
> # ----------------------------------------------------------------
> # Проверяемый А строит стандартную схему RSA
> # ----------------------------------------------------------------
> p1 := nextprime(256512);
> p2 := nextprime(2565121024);
> M := p1*p2;                                          # Открытый ключ 1                                          
> # ----------------------------------------------
> d:=nextprime(12288);                                 # Закрытый ключ
> verify(igcd(d, (p1 - 1) * (p2 - 1)), 1, 'equal');    # Проверка выбора ключа
> # ----------------------------------------------
> e := d &^ (phi((p1 - 1) * (p2 - 1))-1) mod ((p1 - 1) * (p2 - 1)); # Открытый ключ 2
> # ----------------------------------------------------------------
> # Проверяющий В посылает проверяемому А строку x
> # ----------------------------------------------------------------
> x := 12345678901234567890 mod M;
> # ----------------------------------------------------------------
> # Абонент A вычисляет подпись своим закрытым ключом
> # ----------------------------------------------------------------
> s := x  &^ d  mod M;
> # ----------------------------------------------------------------
> # Проверяющий В верифицирует результат
> # ----------------------------------------------------------------
> x1 := s &^ e mod M;
> verify(x - x1, 0, 'equal');
                                   256517
                                 2565121037
                               657997153048129
                                    12289
                                    true
                               86151297222065
                               336315745571592
                               410128164977514
                               336315745571592
                                    true
> 
